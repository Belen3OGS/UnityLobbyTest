/*--------------------------------------------------------------------------------*  Copyright Nintendo.  All rights reserved.  These coded instructions, statements, and computer programs contain proprietary  information of Nintendo and/or its licensed developers and are protected by  national and international copyright laws. They may not be disclosed to third  parties or copied or duplicated in any form, in whole or in part, without the  prior written consent of Nintendo.  The content herein is highly confidential and should be handled accordingly. *--------------------------------------------------------------------------------*/#define ENABLE_WIN_PIA_UNITYusing UnityEngine;using UnityEditor;using System;using System.Collections;using System.Runtime.InteropServices;using System.Collections.Generic;using System.Diagnostics;public partial class PiaPluginInstall{#if UNITY_STANDALONE_WIN    [MenuItem("PiaPlugin/Win Install Develop")]    public static void InstallPiaPluginWin64Develop()    {        InstallPiaPlugin("Win", "Develop");    }    [MenuItem("PiaPlugin/Win Install Release")]    public static void InstallPiaPluginWin64Release()    {        InstallPiaPlugin("Win", "Release");    }#endif#if UNITY_SWITCH#if ENABLE_WIN_PIA_UNITY    [MenuItem("PiaPlugin/NX64 Install Develop(+ Win)")]#else    [MenuItem("PiaPlugin/NX64 Install Develop")]#endif    public static void InstallPiaPluginNx64Debug()    {#if ENABLE_WIN_PIA_UNITY        checkWinRoot("NINTENDO_SDK_PIA_UNITY_ROOT");        InstallPiaPlugin("Win", "Develop");#endif        InstallPiaPlugin("NX64", "Develop");    }#if ENABLE_WIN_PIA_UNITY    [MenuItem("PiaPlugin/NX64 Install Release(+ Win)")]#else    [MenuItem("PiaPlugin/NX64 Install Release")]#endif    public static void InstallPiaPluginNx64Release()    {#if ENABLE_WIN_PIA_UNITY        checkWinRoot("NINTENDO_SDK_PIA_UNITY_ROOT");//        string root = Environment.GetEnvironmentVariable("WIN_PIA_UNITY_ROOT");//        if (root!= null)        {            InstallPiaPlugin("Win", "Release");        }#endif        InstallPiaPlugin("NX64", "Release");    }#endif //UNITY_SWITCH    // Copy the specified platform root environment variable to the Windows version environment variable.    public static void checkWinRoot(string target_env)    {        string win_root = Environment.GetEnvironmentVariable("WIN_PIA_UNITY_ROOT");        if (win_root == null)        {            UnityEngine.Debug.Log("WIN_PIA_UNITY_ROOT is not found");        }        string target_root = Environment.GetEnvironmentVariable(target_env);        if (target_root != null)        {            UnityEngine.Debug.Log("copy from "+target_env +" to WIN_PIA_UNITY_ROOT");            Environment.SetEnvironmentVariable("WIN_PIA_UNITY_ROOT", target_root);        }    }    public static void InstallPiaPlugin(string platform, string buildType)    {        UnityEngine.Debug.Log("***** PLUGIN INSTALL START (" + platform + "-" + buildType + ") ***** ");        string projectFolder = System.IO.Directory.GetCurrentDirectory();        string assetsPath = "";        string arg = "";        string batFileName = "";        assetsPath = projectFolder + "\\Assets";        if (platform == "Win")        {            PiaPlugin.ClosePluginDll();            arg = buildType + " \"" + assetsPath + "\" " + platform;            string root = Environment.GetEnvironmentVariable("WIN_PIA_UNITY_ROOT");            if (root == null)            {                UnityEngine.Debug.Log("WIN_PIA_UNITY_ROOT is not found. Skip Install!");                return;            }            UnityEngine.Debug.Log("WIN_PIA_UNITY_ROOT = " + root);            batFileName = Environment.GetEnvironmentVariable("WIN_PIA_UNITY_ROOT") + "/PiaPlugin/Install_Win.bat";        }        else        {            arg = buildType + " \"" + assetsPath + "\" " + platform;            UnityEngine.Debug.Log("NINTENDO_SDK_PIA_UNITY_ROOT = " + Environment.GetEnvironmentVariable("NINTENDO_SDK_PIA_UNITY_ROOT"));            batFileName = Environment.GetEnvironmentVariable("NINTENDO_SDK_PIA_UNITY_ROOT") + "/PiaPlugin/Install_NX.bat";        }        // Executes batch files (System.Diagnostics Process class).        Process proc = new Process();        proc.StartInfo.FileName = batFileName;        UnityEngine.Debug.Log("batFileName" + batFileName + "arg" + arg);        proc.StartInfo.Arguments = arg;        proc.Start();        proc.WaitForExit();     // Wait until completion.        UnityEngine.Debug.Log("***** PLUGIN INSTALL END *****");    }}